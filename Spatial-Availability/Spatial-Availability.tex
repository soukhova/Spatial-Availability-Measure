\documentclass[]{elsarticle} %review=doublespace preprint=single 5p=2 column
%%% Begin My package additions %%%%%%%%%%%%%%%%%%%
\usepackage[hyphens]{url}

  \journal{Journal of Transport Geography} % Sets Journal name


\usepackage{lineno} % add

\usepackage{graphicx}
%%%%%%%%%%%%%%%% end my additions to header

\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \usepackage{fontspec}
  \ifxetex
    \usepackage{xltxtra,xunicode}
  \fi
  \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
  \newcommand{\euro}{â‚¬}
\fi
% use microtype if available
\IfFileExists{microtype.sty}{\usepackage{microtype}}{}
\bibliographystyle{elsarticle-harv}
\ifxetex
  \usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \usepackage[unicode=true]{hyperref}
\fi
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={},
            pdftitle={Estimating spatial availability/mismatch using singly constrained accessibility measures},
            colorlinks=false,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls

\setcounter{secnumdepth}{0}
% Pandoc toggle for numbering sections (defaults to be off)
\setcounter{secnumdepth}{0}


% tightlist command for lists without linebreak
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}


% Pandoc citation processing
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newlength{\cslentryspacingunit} % times entry-spacing
\setlength{\cslentryspacingunit}{\parskip}
% for Pandoc 2.8 to 2.10.1
\newenvironment{cslreferences}%
  {}%
  {\par}
% For Pandoc 2.11+
\newenvironment{CSLReferences}[2] % #1 hanging-ident, #2 entry spacing
 {% don't indent paragraphs
  \setlength{\parindent}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
  \let\oldpar\par
  \def\par{\hangindent=\cslhangindent\oldpar}
  \fi
  % set entry spacing
  \setlength{\parskip}{#2\cslentryspacingunit}
 }%
 {}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{#1}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{#1}\break}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

\usepackage[font=small,skip=0pt]{caption}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}



\begin{document}


\begin{frontmatter}

  \title{Estimating spatial availability/mismatch using singly
constrained accessibility measures}
    \author[Some School]{Author One}
   \ead{author.1@example.com} 
    \author[Some School]{Author Two\corref{Corresponding Author}}
   \ead{author.2@example.com} 
      \address[Some School]{Address}
      \cortext[1]{Corresponding Author}
  
  \begin{abstract}
  Accessibility measures are widely used in transportation, urban, and
  health care planning, among other applications. By giving a weighted
  sum of the opportunities that can be reached given the cost of
  movement and are interpreted as the potential for spatial interaction.
  While these measures are useful to understand spatial structure there
  are issues in interpretability and spatial biasis which have been
  partially addressed in recently introduced measures such as the
  balanced floating catchment areas (BFCA) and competitive measures of
  accessibility. In following this spirit, we propose a new measure of
  \emph{spatial availability} which is calculated by imposing a single
  constraint on the conventional accessibility measure. Similar to the
  gravity model from which it is derived, a single constraint ensures
  that the marginals at the origin and destination are met and thus the
  number of opportunities are preserved. In this paper, we detail the
  formulation of the proposed spatial availability measure, use-cases of
  the measure using a simple numerical example, and contrast how the
  access to jobs changes between spatial availability and conventional
  accessibility measure using empirical 2016 travel survey data in the
  City of Toronto, Canada. We show that measure of spatial availability
  should be used for opportunities which are individible\ldots. the
  values are more interpretable, less baisised than conventional
  accessibility measure. All data presented and original manuscript are
  openly available.
  \end{abstract}
  
 \end{frontmatter}

\newpage

\hypertarget{introduction}{%
\section{Introduction}\label{introduction}}

The concept of accessibility is a relatively simple one whose appeal
derives from combining the spatial distribution of opportunities and the
cost of reaching them (Hansen, 1959). Numerous methods for calculating
accessibility have been proposed that can be broadly organized into
infrastructure-, place-, person-, and utility-based measures (Geurs and
van Wee, 2004). Of these, the place-based family of measures is arguably
the most common, capturing the number of opportunities reachable from an
origin using the transportation network. This type of measure is also
referred to as a gravity-based measure of accessibility that captures
the potential for interaction.

What accessibility measures is sometimes referred to as
\emph{opportunity access} and the analysis of opportunity access is
widely employed in transportation, geography, public health, and many
other areas, and there is increasing emphasis on a shift from
mobility-oriented to access-oriented planning (Deboosere et al., 2018;
Handy, 2020; Proffitt et al., 2017; Yan, 2021). However, while these
types of opportunity access measures are excellent indicators of the
intersection between urban structure and transportation infrastructure,
they have been criticized in the past for not being highly
interpretable. Previous research has highlighted how the weighting of
opportunities using an impedance function can make gravity measures more
difficult for planners and policymakers to interpret compared to simpler
cumulative opportunity measures (Geurs and van Wee, 2004; Miller, 2018).
Moreover, because place-based measures are sensitive to the number of
opportunities and the characteristics of the transportation network, raw
values cannot be easily compared across study areas (Allen and Farber,
2019).

Intra- and inter-regional comparisons are challenging because
gravity-based accessibility indicators are spatially smoothed estimates
of the total number of opportunities, however, the meaning of their
magnitudes is unclear. This is evident when we consider the ``total
accessibility'' in the region, a quantity that is not particularly
meaningful since it is not constrained to resemble, let alone match the
number of opportunities available. Furthermore, while accessibility
depends on the supply of destination opportunities weighted by the
travel costs associated with reaching them, the calculated
accessibilities are not sensitive to the demand for those opportunities
at the origins. Put another way, traditional measures of place-based
accessibility do not capture the competition for opportunities. This
theoretical shortcoming (Geurs and van Wee, 2004) is particularly
problematic when those opportunities are ``non-divisible'' in the sense
that, once they have been taken by someone, are no longer available to
other members of the population. Examples of indivisible opportunities
include jobs (when a person takes up a job, the same job cannot be taken
by someone else) and placements at schools (once a student takes a seat
at a school, that particular opportunity is no longer there for another
student). From a different perspective, employers may see workers as
opportunities, so when a worker takes a job, this particular individual
is no longer in the available pool of candidates for hiring.

To remedy these issues, researchers have proposed several different
approaches for calculating competitive accessibility values. On the one
hand, this includes several approaches that first normalize the number
of opportunities available at a destination by the demand for them from
the origin zones and, second, sum the demand-corrected opportunities
which can be reached from the origins (e.g. Joseph and Bantock, 1984;
Shen, 1998). These advances were popularized in the family of two-step
floating catchment area methods (Luo and Wang, 2003) that have found
widespread adoption for calculating competitive accessibility to
healthcare and other uses. In principle floating catchment areas purport
to account for competition/congestion effects, although in practice
several researchers (e.g., Delamater, 2013; Wan et al., 2012) have found
that they tend to over-estimate the level of demand and/or service. The
underlying issue, as demonstrated by Paez et al. (2019), is the multiple
counting of both population and level of service, which can lead to
biased estimates if not corrected.

A second approach is to impose constraints on the gravity model to
ensure flows between zones are equal to the observed totals. Based on
Wilson's (1971) entropy-derived gravity model, researchers can
incorporate constraints to ensure that the modeled flows match some
known quantities in the data inputs. In this way, models can be
singly-constrained to match the row- or column-marginals (the trips
produced or attracted, respectively), whereas a doubly-constrained model
is designed to match both marginals. Allen and Farber (2019) recently
incorporated a version of the doubly-constrained gravity model within
the floating catchment area approach to calculate competitive
accessibility to employment using transit across eight cities in Canada.
But while such a model can account for competition, the mutual
dependence of the balancing factors in a doubly-constrained model means
they must be iteratively calculated which makes them more
computationally-intensive. Furthermore, the double constraint means that
the sum of opportunity-seekers and the sum of opportunities must match,
which is not necessarily true in every case (e.g., there might be more
people searching for work than jobs exist in a region).

In this paper we propose an alternative approach to measuring
competitive accessibility. We call it a measure of \textbf{spatial
availability} (SA), and it aims to capture the number of indivisible
opportunities that are not only \emph{accessible} but also
\emph{available} to the opportunity-seeking population, in the sense
that they have not been claimed by a competing seeker of the
opportunity. As we will show, spatial availability is a
singly-constrained measure of accessibility. By allocating opportunities
in a proportional way based on demand and distance, this method avoids
the issues of conglomeration that result from multiple counting of
opportunities in traditional accessibility measures. The method returns
meaningful accessibilities that correspond to the rate of available
opportunities per person. Moreover, the method also returns a benchmark
value for the region under study against which results for individual
origins can be compared.

In the following sections we will describe and illustrate this new
measure using simple numerical examples. First, we will describe the
measure. Second, we will calculate the SA using a simple hypothetical
population and employment centers data set for three use-cases: one of
jobs from the perspective of the population, another considering
catchment restrictions, and another of workers from the perspective of
employers. Thirdly, we calculate the SA using real world data for the
Transportation Tomorrow Survey (TTS) home-to-work commute in 2016 for
the Greater Golden Horseshoe (GGH) area in Ontario, Canada. Finally, we
discuss the differences between accessibility estimates to the proposed
measure of SA and the potential range of uses of the SA measure.

\hypertarget{background}{%
\section{Background}\label{background}}

Most accessibility measures (excluding utility-based measures) are
derived from the gravity model and follow the widely used formulation in
(\ref{eq:conventional-accessibility}). A thorough explanation of this
conventional accessibility measure through a numerical example and its
limitations are detailed in this section. The limitations of the
conventional accessibility measure, namely issues in interpretation and
basis, are the motivation for the \emph{spatial availability} measure
which we propose and describe in the following sections.

\begin{equation}
\label{eq:conventional-accessibility}
A_i = \sum_{j=1}^JO_jf(c_{ij})
\end{equation}

\noindent where:

\begin{itemize}
\tightlist
\item
  \(A\) is accessibility.
\item
  \(i\) is a set of origin locations.
\item
  \(j\) is a set of destination locations.
\item
  \(O_j\) is the number of opportunities at location \(j\). These are
  opportunities for activity and add some sort of \emph{supply} to the
  area;
\item
  \(c_{ij}\) is a measure of the cost of moving between \(i\) and \(j\)
\item
  \(f(\cdot)\) is an impedance function of \(c_{ij}\); it can take the
  form of any monotonically decreasing function (e.g., negative
  exponential distribution) .
\end{itemize}

The accessibility value \(A_i\) is the weighted sum of opportunities
that can be reached from location \(i\), given the cost of travel
\(c_{ij}\) determined by the impedance function \(f(\cdot)\). Summing
the opportunities in the neighborhood of \(i\) (the neighborhood is
defined by the impedance function) estimates of the total number of
opportunities that can be reached from \(i\) at a certain cost. The type
of accessibility value \(A_i\) can be changed depending on the impedance
function, the measure could be cumulative opportunities (if \(f(\cdot)\)
is a binary or indicator function e.g., {[}XX{]}) or a more traditional
gravity measure (e.g., a Gaussian impedance function {[}XX{]}, inverse
cost impedance function {[}XX{]}, ..). .

We use a simple numerical example to introduce the key concepts, and we
will use the usual accessibility measure for comparison. In this way, we
aim to show the differences between accessibility and spatial
availability, which helps to explain how spatial availability can
improve interpretability in the analysis of spatially dispersed
opportunities.

\hypertarget{accessibility-numerical-example}{%
\subsection{Accessibility Numerical
Example}\label{accessibility-numerical-example}}

The setup for the simple numerical example is a system with three
employment centers and nine population centers, as summarized in Table
\ref{tab:toy-example}. The access to jobs for each population center is
calculated using the conventional accessibility measure \(A_i\)
(\ref{eq:conventional-accessibility}). In this numerical example we use
the straight line distance between the population and jobs for
\(c_{ij}\) and a negative exponential function with \(\beta = 0.0015\).
. As noted, \(A_i\) represents the number of jobs (i.e., opportunities)
that can be reached from each population center given the estimated cost
as depicted in Figure \ref{fig:toy-example-accessibility}.

\begin{table}

\caption{\label{tab:toy-example-table}\label{tab:toy-example}Numerical example}
\centering
\begin{tabular}[t]{lrl>{}l}
\toprule
id & number & type & \\
\midrule
E1 & 750 & jobs & \\

E2 & 2250 & jobs & \\

E3 & 1500 & jobs & \\

P1 & 260 & population & \\

P2 & 255 & population & \\

P3 & 510 & population & \\

P4 & 495 & population & \\

P5 & 1020 & population & \\

P6 & 490 & population & \\

P7 & 980 & population & \\

P8 & 260 & population & \\

P9 & 255 & population & \multirow{-12}{*}{\raggedright\arraybackslash \includegraphics{images/figure-1.png}}\\
\bottomrule
\end{tabular}
\end{table}

\begin{figure}
\includegraphics[width=1\linewidth]{Spatial-Availability_files/figure-latex/toy-example-accessibility-plot-1} \caption{\label{fig:toy-example-accessibility}Accessibility of jobs from population centers for the simple numerical example}\label{fig:toy-example-accessibility-plot}
\end{figure}

Figure \ref{fig:toy-example-accessibility} depicts three employment
centers locations (black circles), where the size of the symbol is in
proportion to the number of jobs at each location. We also see nine
population centers (triangles), where the size of the symbol is
proportional to the accessibility (\(A_i\)) to jobs. The accessibility
values illustrates the following:

\begin{itemize}
\item
  Population centers (triangles) in the middle of the plot are
  relatively close to all three employment centers and thus have the
  highest levels of job accessibility. Population center P5 is
  relatively central and close to all employment centers, and it is the
  closest population to the second largest employment center in the
  region. Unsurprisingly, this population center has the highest
  accessibility 680.64);
\item
  Population centers (triangles) near the left edge of the map (only in
  proximity to the small employment center) have the lowest levels of
  job accessibility. Population center P1 is quite peripheral and the
  closest employment center is also the smallest one. Consequently, it
  has the lowest accessibility with \(A_i=\) 17.12);
\end{itemize}

\hypertarget{issues-with-the-conventional-accessibility-measure}{%
\subsubsection{Issues With the Conventional Accessibility
Measure}\label{issues-with-the-conventional-accessibility-measure}}

Accessibility measures are excellent indicators of the intersection
between urban structure and transportation infrastructure . However,
beyond enabling comparisons of relative values they are not highly
interpretable on their own. For instance, from Figure
\ref{fig:toy-example-accessibility}, P1 has lower accessibility than P5
but despite the accessibility value for P1 being relatively low it is
still better than \emph{zero}. To address this interpretability issue,
previous research index and normalize values on a per-capita basis .
However, as recent critical research on accessibility discusses (see for
instance Paez, Higgins, Vivona (2019) and Allen and Farber (2019)),
these steps do not address the bias introduced through the uneven
multiple-counting of opportunities which are unconstrainted by
demand-side competition. We call this issue the `conglomeration effect'
and it arises as a result of the underlying mathematical assumption that
for conventional accessibility \(A_i\) all opportunities for all origins
\(i=1,\cdots,n\) are divisible and non-competitive. This results in
every opportunity entering the weighted sum once for every origin \(i\)
that can reach it. Put another way, if a densely populated population
center pops up next to P5 this center too will have a high accessibility
score since \(A_i\) does not consider competition of opportunities from
neighbouring demand centers. This neglect to constraint opportunity
counts (i.e., single-constraint) obscures the interpretability of
accessibility which may manifests in the following two ways of biased
estimation:

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  less dense urban periphery demand centers may be assigned
  disproportionately \emph{high} accessibility values. These periphery
  areas are traditionally located in proximity to more dense urban
  demand centers and large urban opportunity centers and thus may have
  low travel cost to these large opportunity centers. Accessibility
  \(A_i\) does not consider opportunity-constraints and as such these
  periphery demand centers benefit from the high accessibility to
  opportunities without competition considerations from their more dense
  and more centrally located neighbours.
\item
  remote/isolated areas which are still within the region of the
  analysis and have regionally-relative low demand centers, opportunity
  centers, and travel cost to opportunity centers, are assigned
  disproportionately \emph{low} accessibility values. These
  remote/isolated areas may be sufficiently supplied with opportunities
  proportionate to their demand but is obscured by the artificially high
  accessibility awarded to periphery/other areas in which conglomeration
  disproportionally occurs.
\end{enumerate}

The spatially uneven multiple-counting of opportunities (i.e., the
conglomeration effect) leave decision makers unclear on how to interpret
resulting access values and all recent accessibility measures which seek
to improve interpretability are either vulnerable to this impact or
require potentially unrealistic assumptions . For instance, the floating
catchment areas (FCA) method increases interpretability by purporting to
account for competition, however, as discussed by Paez, Higgins, and
Vivona (2019), FCA methods are vulnerable to conglomeration effect. On
this same note, the doubly-constrained gravity model proposed by Allen
and Farber (2019) which is based on the FCA method accounts for
competition but requires that the magnitude of demand matches the
opportunities. As already mentioned, this assumption is not always
realistic for many opportunity types such as in the case of job seekers
and jobs.

To address the conglomeration effect and introduce a more realistic
assumption for opportunities, we propose a singly-constrained gravity
measure called \textbf{spatial availability}. This measure fundamentally
seeks to answer for a individual at a specific population center the
following questions: \emph{``many jobs are accessible, but the same jobs
are also accessible to my (possibly) numerous neighborus\ldots{} what
does a high accessibility actually mean to me?''} and \emph{``few jobs
are accessible but I am located in a remote area with proportionally few
neighbours\ldots{} what does low accessibility mean to me?''}.

\hypertarget{the-analytical-framework-of-spatial-availability}{%
\subsection{The Analytical Framework of Spatial
Availability}\label{the-analytical-framework-of-spatial-availability}}

Spatial availability \(V_{ij}\) is defined by opportunities \(O\) which
are proportionally allocated based on the relative population allocation
factor \(F^p_{ij}\) and cost of travel allocation factor \(F^c_{ij}\)
for all origins \(i\) to all destinations \(j\) as detailed in
(\ref{eq:spatial-availability}). In line with the gravity tradition, the
proposed framework distinguishes between opportunities at a destination
and demand for opportunities at the origin.

\begin{equation}
\label{eq:spatial-availability}
V_{ij} = O_j\frac{F^p_{ij} \cdot F^c_{ij}}{\sum_{i=1}^K F^p_{ij} \cdot F^c_{ij}}
\end{equation}

\noindent where:

\begin{itemize}
\tightlist
\item
  \(V_{ij}\) is spatial availability.
\item
  \(i\) is a set of origin locations in the region \(K\).
\item
  \(j\) is a set of destination locations in the region \(K\).
\item
  \(O_j\) is the number of opportunities at location \(j\) in the region
  \(K\).
\item
  \(F^p_{ij}\) is the proportional allocation factor of the population
  in \(i\) relative to the population in region \(K\).
\item
  \(F^c_{ij}\) is the proportion allocation factor of travel cost for
  \(i\) relative to the travel cost in region \(K\); it is a product of
  a monotonically decreasing (i.e., impedance) function associated with
  the cost of travel between \(i\) and \(j\).
\end{itemize}

To explain the analytical framework, the calculation of \emph{job
access} is illustrated with a simple step-by-step example for two
population centers (\(P_2\) and \(P_3\)) in the role of demand (i.e.,
the number of individuals in the labour market who ``demand''
employment) and one employment center (\(O_1\)) in the role of
opportunities.

Additionally, since spatial availability \(V_{ij}\) consists of these
two allocation factors, we detail first how the role of population
allocation factor \(F^p_{ij}\) in producing \(V^p_{ij}\), next the role
of the travel cost allocation factor \(F^c_{ij}\) in producing
\(V^c_{ij}\), and finally how both allocation factors in the final
general form of spatial availability \(V_{ij}\) are combined.

\hypertarget{population-and-travel-cost-allocation-factors}{%
\subsubsection{Population and Travel Cost Allocation
Factors}\label{population-and-travel-cost-allocation-factors}}

We begin with allocation based on demand; consider an employment center
\(j\) with \(O_j^r\) jobs of type \(r\). In the general case where there
are \(K\) population centers in the region, the following factor can be
defined (\ref{eq:pop-alloc-factor}).

\begin{equation}
\label{eq:pop-alloc-factor}
F^p_{ij} = \frac{P_{i\in r}^\alpha}{\sum_{i=1}^K P_{i\in r}^\alpha}
\end{equation}

The population allocation factor \(F^p_{ij}\) corresponds to the
proportion of the population in origin \(i\) relative to the rest of the
region's population centres \(K\). On the right hand side of the
equation, the numerator \(P_{i\in r}\) is the population at origin \(i\)
that is eligible and `demand' jobs of type \(r\) (maybe those with a
certain level of training or in a designated age group). The summation
in the denominator is over \(i=1,\cdots,K\), the number of population at
all origins \(i\) in the region \(K\). To modulate the effect of the
size in from this factor we also add an empirical parameter \(\alpha\)
(i.e., \(\alpha <1\) places greater weight on smaller centres relative
to larger ones while \(\alpha>1\) achieves the opposite effect). This
population allocation factor \(F^p_{ij}\) can now be used to
proportionally allocate a share of the jobs at a destination \(j\) to
all origin pairs.

More broadly, since the factor \(F^p_{ij}\) is a proportion, when it is
summed over \(i=1,\cdots,K\) it always equals to 1 (i.e.,
\(\sum_i^{K} F^p_{ij} = 1\)). This is notable since the share of jobs
(the spatial availability based on population \(V^p_{ij}\)) at each
destination \(j\) allocated to (i.e., available to) each origin is equal
to \(V^p_{ij} = O_j \cdot F^p_{ij}\) and since the sum of F\^{}p\_\{ij\}
is equal to 1 it follows that \(\sum_{i=1}^I V_{ij} = O_j\). In other
words, the number of jobs across the region is preserved. The result is
a proportional allocation of jobs (opportunities) to origins based on
population demand; this factor does not consider travel cost, that is
defined in the travel cost allocation factor \(F^c_{ij}\) which is
introduced shortly.

To illustrate the population allocation factor, consider an employment
center has 300 jobs (\(O_1= 300\)) in a region with two population
centers which have 240 and 120 people, respectively, (\(P_2= 240\) and
\(P_3 = 120\)). For simplicity, assume that all the population in the
region is eligible for these jobs, that is, that the entirety of the
population is included in the set \(r\). Also assume that \(\alpha=1\)
meaning the only impact on value is the population size for each center.
The population allocation factors \(F^p_{ij}\) for the jobs at \(O_1\)
for each population center \(P_2\) and \(P_3\) would be defined as
(\ref{eq:pop-alloc-factor-2populations}).

\begin{equation}
\label{eq:pop-alloc-factor-2populations}
\begin{array}{l}\
F^p_{2,1} = \frac{P_2 ^\alpha}{P_2^\alpha + P_3^\alpha} = \frac{240}{240 + 120} = \frac{240}{360}\\
F^p_{3,1} = \frac{P_3^\alpha}{P_2^\alpha + P_3^\alpha}  = \frac{120}{240 + 120} = \frac{120}{360}\\
\end{array}
\end{equation}

The \(F^p_{ij}\) values can be used to find a \emph{partial} spatial
availability of jobs which is only defined by the relative population
demanding jobs; this partial spatial availability \(V^p_{ij}\) for each
population center would be calculated as follows in
(\ref{eq:pop-alloc-factor-SA-2populations}).

\begin{equation}
\label{eq:pop-alloc-factor-SA-2populations}
\begin{array}{l}\
V^p_{2,1} = O_1 \cdot F^p_{2,1} = 300 \cdot \frac{240}{360} = 200 \\
V^p_{3,1} = O_1 \cdot F^p_{3,1} = 300 \cdot \frac{120}{360} = 100 \\
\end{array}
\end{equation}

It can be seen that when using only the proportional allocation factor
\(F^p_{ij}\) to calculate spatial availability (differentiated here by
being defined as \(V^p_{ij}\) instead of \(V_{ij}\)), proportionally
more jobs are allocated to the bigger population center (i.e., 2 times
more jobs as it is 2 times larger in population). We can also see that
the sum of spatial availability for all population centers is equal to
the sum of jobs, i.e., total opportunities are preserved. However, as
mentioned, using only the proportional allocation factor \(F^p_{ij}\) to
calculate spatial availability does not account for how far population
centers \(P_2\) or \(P_3\) are from employment center \(O_1\). To
account for this effect we introduce a second allocation factor
\(F^c_{ij}\) based on distance to the employment centers defined in
(\ref{eq:tcost-alloc-factor}).

\begin{equation}
\label{eq:tcost-alloc-factor}
F^c_{ij} = \frac{f(c_{ij})}{\sum_{i=1}^K f(c_{ij})}\\
\end{equation}

Where \(c_{ij}\) is the cost (e.g., the distance, travel time, etc.)
from population center \(i\) to employment center \(j\), and
\(f(\cdot)\) is an impedance function that is a monotonically decreasing
function of cost (\(c_{ij}\)); in other words, the travel cost
allocation factor \(F^c_{ij}\) serves to proportionally allocates more
jobs to closer locations through an impedance function. To continue
illustrating, assume that the impedance function is a negative
exponential function and assume that \(\beta\) (which modulates the
steepness of the impedance effect and is an empirical parameter) is the
value of 1 for simplicity. Also suppose that the distance from
population center \(P_2\) to employment center \(O_1\) is 0.6 km, and
the distance from population center \(P_3\) to employment center \(O_1\)
is 0.3 km. The proportional allocation factor \(F^p_{ij}\) for the jobs
at \(O_1\) for both population centers \(P_2\) and \(P_3\) is defined as
follows (\ref{eq:tcost-allocation-factor-2populations}).

\begin{equation}
\label{eq:tcost-allocation-factor-2populations}
\begin{array}{l}\
F^c_{2,1} = \frac{\exp(-\beta \cdot D_{2,1})}{\exp(-\beta \cdot D_{2,1}) + \exp(-\beta \cdot D_{3,1})} = \frac{\exp(-0.6)}{\exp(-0.6) + \exp(-0.3)} = 0.426\\
F^c_{3,1} = \frac{\exp(-\beta \cdot D_{3,1})}{\exp(-\beta \cdot D_{2,1}) + \exp(-\beta \cdot D_{3,1})}  = \frac{\exp(-0.3)}{\exp(-0.6) + \exp(-0.3)} = 0.574\\
\end{array}
\end{equation}

We can see that the proportional allocation factor for \(P_3\) is larger
than \(P_2\) since the distance to \(O_1\) is shorter. Using the travel
cost proportional allocation factors \(F^c_{ij}\) as defined in
(\ref{eq:tcost-allocation-factor-2populations}), we can now calculate
the spatial availability of jobs for each population center based only
on \(F^c_{ij}\) and the jobs available \(O_1\) to these two competing
population centers (note: \(V^c_{ij}\) not the complete \(V_{ij}\)) as
follows in (\ref{eq:tcost-allocation-factor-SA-2populations}).

\begin{equation}
\label{eq:tcost-allocation-factor-SA-2populations}
\begin{array}{l}\
V^c_{2,1} = O_1 \cdot F^c_{2,1} = 300 \times 0.426 = 127.8\\
V^c_{3,1} = O_1 \cdot F^c_{3,1} = 300 \times  0.574 = 172.2\\
\end{array}
\end{equation}

As shown, the spatial availability defined by \(F^c_{ij}\) (i.e.,
\(V^c_{ij}\)) allocates \(P_3\) a larger share of jobs since the
population center is closer to \(O_1\). However, as previously
discussed, \(P_3\) has a smaller population than \(P_2\), so \(P_2\)
receives a larger share of jobs when spatial availability when it is
defined by \(F^p_{ij}\) (i.e., \(V^p_{ij}\)). It is necessary to combine
both population and travel cost factors to accurate reflect demand;
these two components are in line with how demand is conventionally
modelled in accessibility calculations. Fortunately, since both
\(F^c_{ij}\) and \(F^p_{ij}\) preserve the total number of opportunities
(jobs) as they independently sum to 1, they can be combined
multiplicatively to calculate the proposed spatial availability
(\(V_{ij}\)) which considers demand to be based on both population and
travel cost.

\hypertarget{putting-spatial-availability-together}{%
\subsubsection{Putting Spatial Availability
Together}\label{putting-spatial-availability-together}}

We can combine the proportional allocation factors by population
\(F^p_{ij}\) and travel cost \(F^c_{ij}\) and calculate spatial
availability \(V_{ij}\) as introduced in (\ref{eq:spatial-availability})
and repeated below:

\[
V_{ij} = O_j\frac{F^p_{ij} \cdot F^c_{ij}}{\sum_{i=1}^K F^p_{ij} \cdot F^c_{ij}}
\]

To complete the illustrative example of employment center \(O_1\) and
population centers \(P_2\) and \(P_3\), the resulting spatial
availability \(V_{ij}\) is calculated for both population centers is
calculated in (\ref{eq:SA-2populations}).

\begin{equation}
\label{eq:SA-2populations}
\begin{array}{l}\
V_{2,1} = O_1\cdot \frac{F^p_{2,1} \cdot F^c_{2,1}}{F^p_{2,1} \cdot F^c_{2,1} + F^p_{3,1} \cdot F^c_{3,1}} = 300 \frac{\big(\frac{2}{3} \big) \big(0.426 \big)}{\big(\frac{2}{3} \big) \big(0.426 \big) + \big(\frac{1}{3} \big) \big(0.574 \big)} = 179.4\\
V_{3,1} = O_1\cdot \frac{F^p_{3,1} \cdot F^c_{3,1}}{F^p_{2,1} \cdot F^c_{2,1} + F^p_{ik} \cdot F^c_{ik}} = 300 \frac{\big(\frac{1}{3} \big) \big(0.574 \big)}{\big(\frac{2}{3} \big) \big(0.426 \big) + \big(\frac{1}{3} \big) \big(0.574 \big)}  =  120.6 \\
\end{array}
\end{equation}

As can be seen, fewer number of jobs are allocated to population center
\(P_2\) compared to the allocation by population only, to account for
the higher cost of reaching the employment center. On the other hand,
distance alone allocated more jobs to the closest population center
(i.e., \(P_3\)), but since it is smaller, it also gets a smaller share
of the jobs overall. To reiterate, the sum of jobs at employment center
\(O_1\) that are allocated to population centers \(P_2\) and \(P_3\)
simultaneously based on \emph{population-} and \emph{travel cost}
allocation factors are preserved (i.e., \(V_{2,1} + V_{3,1} = O_1\)).

In the common case that population centers have multiple destination
opportunities \(j\), availability is simply the sum of
(\ref{eq:spatial-availability}) for all opportunities \(J\) (i.e.,
\(V_i = \sum_{j=1}^J V_{ij}\)). This quantity represents opportunities
(e.g., jobs) that can be accessed from \(i\) and that are \emph{not}
allocated to a competitor: therefore the weighted sum of available
opportunities. Compare \(V_i\) to the singly-constrained gravity model
(see Wilson (1971)) . In essence, \(V_i\) is the result of constraining
\(A_i\) to match one of the marginals in the origin-destination table,
the known total of opportunities.

Since the sum of opportunities is preserved in the procedures above, it
is possible to calculate a highly interpretable measure of spatial
availability per capita (lower-case \(v_i\)) as follows in
(\ref{eq:SA-per-capita}).

\begin{equation}
\label{eq:SA-per-capita}
v_i = \frac{V_i}{P_i}
\end{equation}

To complete the illustrative example, the per capita spatial
availability of jobs would be calculated as follows in
(\ref{eq:SA-per-capita-2populations}).

\begin{equation}
\label{eq:SA-per-capita-2populations}
\begin{array}{l}\
v_{2,1} = \frac{V_{2,1}}{P_2} =  \frac{179.4}{240} = 0.8\\
v_{3,1} =  \frac{V_{3,1}}{P_3} =  \frac{120.6}{120} = 1.0\\
\end{array}
\end{equation}

We can see that since \(P_3\) is closer to \(O_1\) and has less
competition (as it has a smaller population than \(P_2\)), \(P_3\)
benefits with a higher spatial availability of jobs per capita.

Where the overall ratio of jobs to population in the region is
\(300/(240 + 120)=\) 0.83, the spatially available jobs per capita at
\(k\) is closer to unity.

\hypertarget{empirical-example-spatial-availability-and-accessibility-of-jobs-in-toronto}{%
\section{Empirical Example: Spatial Availability and Accessibility of
Jobs in
Toronto}\label{empirical-example-spatial-availability-and-accessibility-of-jobs-in-toronto}}

In this section, we calculate both spatial availability () and
accessibility () using empirical data for home-based work trips in the
Greater Golden Horseshoe (GGH) area. We first introduce the data used,
then illustrate two cases in which the multiple-counting property of
accessibility obscurs intrepretability and spatial availability
addresses it.

\hypertarget{data}{%
\subsection{Data}\label{data}}

The 2016 Transportation Tomorrow Survey (TTS) data for 20 municipalities
contained within the GGH area in the province of Ontario, Canada (43.6Â°N
79.73Â°W) is analysed (Figure \ref{fig:TTS-16-survey-area}). This data
set includes home-based origins and employment destinations defined by
centroids of Traffic Analysis Zones (TAZ) of varying areas (n=3764), the
number of jobs (n=3081900) and workers (n=3446957) at each origin and
destination, and the trips from origin to destination for the morning
home-to-work commute (n=3446957). Also included are calculated travel
times by car (calculated via
\href{https://github.com/ipeaGIT/r5r}{\texttt{r5r}}) and a derived
impedance function values corresponding to the cost of travel based on
the trip length distribution (TLD). The descriptive statistics are
presented in Table \ref{tab:TTS-16-desc-stats} and a
\href{https://github.com/soukhova/AccessPack}{data-package} is available
to explore the data in greater detail.

\begin{figure}

{\centering \includegraphics[width=0.7\linewidth]{images/Greater-Golden-Horseshoe-Map} 

}

\caption{\label{fig:TTS-16-survey-area}The TTS 2016 study area within the Greater Golden Horseshoe in Ontario, Canada.}\label{fig:TTS-16-survey-area}
\end{figure}

\begin{table}

\caption{\label{tab:unnamed-chunk-1}\label{tab:TTS-16-desc-stats}Descriptive statistics of the TTS 2016 dataset for the Greater Golden Horshoe Area}
\centering
\begin{tabular}[t]{l|l|l}
\hline
  & Trips & Travel\_Time\\
\hline
 & Min.   :   1.00 & Min.   :  0.00\\
\hline
 & 1st Qu.:  14.00 & 1st Qu.: 13.00\\
\hline
 & Median :  22.00 & Median : 20.00\\
\hline
 & Mean   :  33.44 & Mean   : 23.39\\
\hline
 & 3rd Qu.:  38.00 & 3rd Qu.: 30.00\\
\hline
 & Max.   :1129.00 & Max.   :179.00\\
\hline
 & NA & NA's   :3507\\
\hline
\end{tabular}
\end{table}

\hypertarget{calibrating-an-impedance-function}{%
\subsection{Calibrating an Impedance
Function}\label{calibrating-an-impedance-function}}

In the hypothetical toy data set, an arbitrary negative exponential
function describing the increase in travel cost as distance increases
was used as the impedance function to derive both accessibility and
availability. In this data set, an impedance function can be derived
from the empirical trip length distribution (TLD) as the number of trips
and their travel cost (in the case, travel time in minutes) are known
(see black data points in Figure \ref{fig:TLD-Gamma-plot}).

The TLD density plot appears to follow a gamma distribution, as such,
this theoretical distribution along with other common TLD distributions
such as log-normal and exponential distributions were fitted to the
empirical TLD using the maximum likelihood estimation method and
Nelder-Mead method for direct optimization available within the
fitdistrplus package in R (Delignette-Muller and Dutang, 2015; R Core
Team, 2021) . Based on goodness-of-fit criteria, the gamma distribution
was selected (see red line in Figure \ref{fig:TLD-Gamma-plot}). The
gamma distribution function is given in the following general form: \[ 
f(x, \alpha, \beta) = \frac {x^{\alpha-1}e^{-\frac{x}{\beta}}}{ \beta^{\alpha}\Gamma(\alpha)} \quad \text{for } 0 \leq x \leq \infty
\] \noindent where the estimated `shape' is \(\alpha\),the estimated
`rate' is \(\beta\), and \(\Gamma(\alpha)\) is defined as:

\[
\Gamma(\alpha) =  \int_{0}^{\infty} x^{\alpha-1}e^{-x} \,dx
\]

\begin{figure}
\includegraphics[width=1\linewidth]{images/impedance_function} \caption{\label{fig:impedance-function-plot}Impedance function and diagnostics.}\label{fig:plot-impedance-function}
\end{figure}

\begin{verbatim}
Warning: Removed 123 rows containing missing values (geom_point).
\end{verbatim}

\begin{figure}
\includegraphics[width=1\linewidth]{Spatial-Availability_files/figure-latex/TLD-Gamma-plot-1} \caption{\label{fig:TLD-Gamma-plot}Empirical TTS 2016 home-based car trip length distribution (black) and calibrated gamma distribution impedance function (red)}\label{fig:TLD-Gamma-plot}
\end{figure}

The calibrated impedance function has a shape parameter of 2.019 and a
rate parameter of 0.094. The function and diagnostics are plotted in
Figure \ref{fig:impedance-function-plot} and the predicted values are
plotted alongside the empirical TLD in Figure \ref{fig:TLD-Gamma-plot}.
As a point of summary, values calculated by this calibrated impedance
function captures our theoretical cost of travel (i.e.~probability of
travel based on the trip length distribution of empirical trips and
associated travel time) within the following accessibility and spatial
availability calculations.

\hypertarget{accessibility-and-spatial-availability-of-jobs-in-toronto}{%
\subsection{Accessibility and Spatial Availability of Jobs in
Toronto}\label{accessibility-and-spatial-availability-of-jobs-in-toronto}}

In this section we calculate \emph{job access} for subset of jobs and
workers in the GGH to demonstrate the first property of the spatial
availability measure: not including a the single-constraint in
accessibility overestimates \emph{job access} for TAZ with a low
proportion of workers (relative to TAZs with higher jobs). This is
demonstrated by using the impedance function defined in the previous
section and calculating accessibility and spatial availability to
employment destinations only within the boundaries of Toronto from
home-based origins anywhere in the GGH. It should be noted that Toronto
represents a significant subset of workers and jobs in the GGH; 50\% of
workers in the GGH travel to jobs in Toronto and 72\% of jobs are
located within Toronto.

Accessibility is first calculated in which the higher the accessibility
value, the more accessible places of employment are to home-based
origins as seen in Figure \ref{fig:plot-accessibility-Toronto-TTS}. It
can be briefly summarized that the accessibility values follow a radial
trend where the majority of TAZs in Toronto have high accessibility
values and values decrease in TAZs which are further from the city
boundary.

Next, the spatial availability using the same impedance function is
calculated for the same survey area; the higher the spatial availability
value the more available employment destinations in Toronto are to any
home-based origins in the GGH (Figure \ref{fig:plot-avail-Toronto-TTS}).
If a TAZ has a spatial availability value which is higher or lower than
NA it has above or below average spatial availability of jobs relative
to all job opportunities within the City of Toronto (for all origins in
the GGH). Spatial availability can also be normalized per workers within
each TAZ to provide meaningful insight on how many jobs are
\emph{available} on average for each TAZ. This normalization, shown in
Figure \ref{fig:plot-avail-Toronto-TTS-per-worker}, demonstrates which
TAZ have above and below the average (NA) available jobs per worker in
the GGH (to jobs located within the city of Toronto). It can be briefly
summarized that the spatial availability measure has a smaller and less
pronounced radial impact than the accessibility measure; TAZs within and
immediately outside the boundary of Toronto have above average spatial
availability of jobs but at a lower relative intensity than compared to
the availability measure. Additionally, more TAZs outside of Toronto
have low spatial availability values.

\begin{figure}
\includegraphics[width=1\linewidth]{Spatial-Availability_files/figure-latex/plot-access-SA-Toronto-TTS-1} \caption{\label{fig:plot-access-SA-Toronto-TTS}Calculated accessibility (top) and spatial availability (bottom) of employment from origins in the GGH to destinations in the City of Toronto.}\label{fig:plot-access-SA-Toronto-TTS}
\end{figure}

\begin{figure}
\includegraphics[width=1\linewidth]{Spatial-Availability_files/figure-latex/plot-avail-Toronto-TTS-per-worker-1} \caption{\label{fig:plot-avail-Toronto-TTS-per-worker}Calculated spatial availability of employment, per worker, from origins in the GGH to destinations in the City of Toronto.}\label{fig:plot-avail-Toronto-TTS-per-worker}
\end{figure}

\hypertarget{accessibility-and-spatial-availabiltiy-of-all-jobs-in-ggh}{%
\subsection{Accessibility and Spatial Availabiltiy of all jobs in
GGH}\label{accessibility-and-spatial-availabiltiy-of-all-jobs-in-ggh}}

In this section we calculate \emph{job access} for the entire GGH to
demonstrate the second property of the spatial availability measure: not
including a the single-constraint in accessibility underestimates
\emph{job access} for TAZ with a low proportion of workers (relative to
TAZs with higher jobs), meaning less populous TAZ areas accessibility
underestimates \emph{job access}. This is demonstrated by using the
impedance function defined and calculating accessibility and spatial
availability to employment destinations in Toronto from home-based
origins anywhere in the GGH.

Accessibility is first calculated in which the higher the accessibility
value, the more accessible places of employment are to home-based
origins as seen in Figure \ref{fig:plot-accessibility-GGH-TTS}. It can
be briefly summarized that the accessibility values follow a radial
trend where the majority of TAZs in Toronto have high accessibility
values and values decrease in TAZs which are further from the city
boundary.

\begin{verbatim}
old-style crs object detected; please recreate object with a recent sf::st_crs()
old-style crs object detected; please recreate object with a recent sf::st_crs()
\end{verbatim}

\begin{figure}
\includegraphics[width=1\linewidth]{Spatial-Availability_files/figure-latex/plot-access-SA-GGH-1} \caption{\label{fig:plot-access-SA-GGH-TTS}Calculated accessibility (top) and spatial availability (bottom) of employment from origins in the GGH to destinations in the GGH.}\label{fig:plot-access-SA-GGH}
\end{figure}

\begin{verbatim}
old-style crs object detected; please recreate object with a recent sf::st_crs()
\end{verbatim}

\begin{figure}
\includegraphics[width=1\linewidth]{Spatial-Availability_files/figure-latex/plot-avail-GGH-TTS-per-worker-1} \caption{\label{fig:plot-avail-GGH-TTS-per-worker}Calculated spatial availability of employment, per worker, from origins in the GGH to destinations in the City of Toronto.}\label{fig:plot-avail-GGH-TTS-per-worker}
\end{figure}

\hypertarget{discussion}{%
\section{Discussion}\label{discussion}}

\hypertarget{comparing-opportunity-access-measures---toronto}{%
\subsection{Comparing Opportunity Access Measures -
Toronto}\label{comparing-opportunity-access-measures---toronto}}

Accessibility and spatial availability in our example both measure
\emph{access to jobs}. However, these two measures cannot be
meaningfully compared through normalization on a per worker basis since
the accessibility methodology inherently multiple-counts opportunities.
We thus take a different approach to compare the relative magnitudes
(within each measure) by re-scaling both measures from 0 to 100 where
each value of the measure is divided by the maximum value. The
percentage change between re-scaled spatial availability and
accessibility for each TAZ is then calculated;98.9\% of TAZs have lower
re-scaled spatial availability values than accessibility values and they
are on average -80.64\% different and range between -2.95\% to -99.9\%
different than re-scaled accessibility. To simplify the presentation of
percentage change in difference between measures, five quantiles are
calculated and coloured to represent each TAZ in Figure
\ref{fig:indexed-measures-comparison-plot}. The quantile ranks range
from 1 to 5 where 1 represents the highest percentage difference between
spatial availability and accessibility. In other words, the higher the
quantile rank, the more pronounced the overestimation of \emph{job
access} is in that TAZ when referring to the accessibility measure
relative to the spatial availability measure. It should be noted that
the 1.1\% of TAZs which experience a positive change between the
re-scaled measures are shown in grey.

\begin{verbatim}
Warning: Duplicated aesthetics after name standardisation: colour
\end{verbatim}

\begin{figure}
\includegraphics[width=1\linewidth]{Spatial-Availability_files/figure-latex/indexed-measures-comparison-plot-1} \caption{\label{fig:indexed-measures-comparison-plot}Difference in rescaled accessbility and spatial availability values in the context of employment from origins in the GGH to destinations in the City of Toronto. TAZs with rescaled spatial accessibility values that are lower than rescaled accessibility values are presented in five quantiles from 1 to 5 with 1 representing the highest negative change between spatial availability and accessibility. TAZs with values which are higher than re-scaled accessibility are shown in grey.}\label{fig:indexed-measures-comparison-plot}
\end{figure}

We can see from Figure \ref{fig:indexed-measures-comparison-plot} that
when we re-scale the accessibility values, they consistently
overestimate \emph{job access} compared to the re-scaled spatial
availability measure. Overestimation ranges from -3\% to -100\% and is
on average -81\%. However, while accessibility consistently
overestimates \emph{job access} relative to spatial availability, it
does so in a variable way. \emph{Job access} is more overestimated in
TAZs that have a low number of workers and is less overestimated in TAZs
with a high number of workers; the correlation between the number of
workers and the percentage difference between measures is 0.877. As
such, the TAZs that have a relatively low number of workers are located
between the border of the GGH and the City of Toronto and are also
mostly coloured by red and orange indicating Quantiles 1 and 2 (highest
percentage of overestimation) and vice versa. Both \emph{job access}
measures are more similar when the number of workers correlates with
travel cost and the number of jobs at the destination. However, when the
calibrated travel cost outpaces the number of workers, as is the case
for the low-worker TAZs within this empirical example, then these
measures increasingly diverge. This difference emphasizes the importance
in using an accurate and well-informed impedance function and
origin-destination data. For reference to these trends, the plots for
workers and impedance function values for all TAZs are presented in
Figure \ref{fig:plot-workers-imp}.

\begin{figure}
\includegraphics[width=1\linewidth]{Spatial-Availability_files/figure-latex/plot-workers-imp-1} \caption{\label{fig:plot-workers-imp}Number of workers (top) and average impedance function value (bottom) for each origin TAZ in the GGH.}\label{fig:plot-workers-imp}
\end{figure}

Accessibility when used to measure \emph{job access} obscures the
\emph{availability} of jobs. Overall, this can be seen when comparing
Figure \ref{fig:plot-accessibility-Toronto-TTS} and Figure
\ref{fig:plot-avail-Toronto-TTS} where the intra-measure magnitude of
accessibility is much higher within and closer to the boundary of the
City of Toronto while spatial availability is more level as it is
proportioned by the number of workers within each origin TAZs. Since
spatial availability is proportioned by the number of workers, the
resulting \emph{job access} value is numerically meaningful to determine
what \emph{job access} is available per worker and how it compares to
the average \emph{job access} for the region. In this way, spatial
availability is more interpretable than accessibility as it can be
stated that the average Toronto jobs per worker is XX for the GGH and XX
for Toronto; interestingly, all TAZs in Toronto have a higher \emph{job
access} than the GGH value but still range between XX and XX.

\hypertarget{comparing-opportunities-access-measures---all-ggh}{%
\subsection{Comparing Opportunities Access Measures - All
GGH}\label{comparing-opportunities-access-measures---all-ggh}}

\begin{figure}
\includegraphics[width=1\linewidth]{Spatial-Availability_files/figure-latex/indexed-measures-comparison-plot-GGH-1} \caption{\label{fig:indexed-measures-comparison-plot-GGH}Difference in rescaled accessbility and spatial availability values for access to employement in the GGH. TAZs with rescaled spatial accessibility values that are lower (top) and higher (bottom) than rescaled accessibility values are presented in five quantiles from 1 to 5 with 1 representing the highest magnitude of change between spatial availability and accessibility.}\label{fig:indexed-measures-comparison-plot-GGH}
\end{figure}

\hypertarget{contextualizing-spatial-availability-use-cases}{%
\subsection{Contextualizing Spatial Availability Use
Cases}\label{contextualizing-spatial-availability-use-cases}}

Note: \(A_i\) is vulnerable to the modifiable areal unit problem (MAUP)

With the toy and empirical example presented, we propose that spatial
availability be seen as a type of \emph{spatial mismatch} and an
evolution of the \emph{balanced floating catchment} approach (BFCA) .
Historically, literature has iteratively improved measures assessing
access to opportunities. In the context of employment and healthcare
opportunities, simple container counting solutions such as the
population-to-provider ratio (PPR) for healthcare services and jobs to
housing ratio were implemented. This approach, while straight forward,
is highly sustible to the modifiable unit area problem (MUAP).
Recognizing this and harnessing the computation power and access to
finer resolution data as it became available, scholars proposed the next
evolution, namely the accessibility measure which is widely used today
and we implemented in our examples for comparison. It partially
addresses the MUAP by considering opportunities outside of the
conventional `containers' which represented opportunities in a census
areas/neighbourhoods by counting opportunities informed by an impedance
function based on travel cost. Our measure, spatial availability,
iterates on the accessibility measure by proportionally allocating
travel cost and population (workers) of origins to opportunities at
destinations. This single-constrained approach ensures that the
population is mutually exclusive in essence replicating the properties
of the self-contained unit which is \emph{not} limited to a zoning
system proposed; the pros of accessibility solution in using the
impedance function and pros of the container solutions.

Similar to the accessibility measure, it should be noted that spatial
availability is only as robust to the MUAP as the input data allows. For
instance, in the empirical example present, the measure of \emph{job
access} still only considers population, opportunities, and travel times
from the centroids of TAZs. However, unlike the accessibility measure,
spatial availability can be meaningful calculated on a per population
basis at higher resolutions because of the proportionality property.

Further, the measure of spatial availability can be a useful way to
distinguish between low accessibility/low population centers, which may
enjoy higher availability than the accessibility value may suggest, and
contrariwise, high accessibility/high population centers (which
potentially can result in lower availability due to competition). For
instance, as presented in the numerical example, more remote, smaller
population centers can have sufficient spatial availability by being in
close proximity to the smaller employment centers; however this
sufficiency is obscured by accessibility measure by conglomerating
accessibly of population centers which are more central to more (and
larger) employment centers. Conversely, referring to the empirical GGH
example, the TAZs that are relatively close to the Toronto job
destinations but have a relatively low number of workers receive
sufficiently high values of accessibility and signficantly lower spatial
availability values; this trend is opposite to what is experienced in
the numerical example and is a result of higher job competition
(i.e.~job opportunities are more highly allocated to TAZs with lower
travel costs and higher worker populations). Measuring access to
opportunities is a multi-scale problem; since the number of
opportunities are preserved, different scales, populations, and
time-windows can be incorporated within the measure without introducing
additional spatial basis.

Fundamentally, accessibility measure's methodology results in the
overestimation of \emph{jobs access} since it simply sums the count of
destination opportunities based on travel cost to opportunities; the
measure does not include factors to bound the summation so origins,
hypothetically, can have infinite \emph{opportunity access}. This
property can be practical for calculating \emph{opportunity access} for
opportunities which have large capacities and are \emph{non-competitive}
such as large natural parks and beaches. These non-competitive
opportunities can be considered infinitely divisible as they offer more
`spots' at any given time than the population. However, often times
opportunities are not divisible but are in fact indivisible and
competitive meaning, such as the numerical and GGH empirical example of
\emph{jobs access}, where only 1 worker can access 1 job at any given
time. In these cases, spatial availability measure can be used to
calculate the \emph{opportunity access} in which the report values are
numerically meaningful, the MUAP is potentially addressed, and
\emph{opportunity access} values across regions, neighbourhoods, and
spatial scales can be compared.

\hypertarget{spatial-availability-use-cases}{%
\subsection{Spatial Availability Use
Cases}\label{spatial-availability-use-cases}}

With the analytical framework for spatial availability outlined, in the
following sub-sections, we return to the numerical example which was
introduced at the start of this
\protect\hyperlink{accessibility-numerical-example}{section} and
illustrate how spatial availability \(V_i\) can be used for two other
use cases.

\hypertarget{available-jobs-for-the-working-population}{%
\subsubsection{Available Jobs for The Working
Population}\label{available-jobs-for-the-working-population}}

In this use case, we calculate the spatial availability of jobs using
the same impedance function that was used to calculate job accessibility
in Figure \ref{fig:toy-example-accessibility}. The spatial availability
calculations are implemented in the function \texttt{sp\_avail}. The
inputs are an Origin-Destination table with labels for the origins
(\texttt{o\_id}), labels for the destinations (\texttt{d\_id}), the
population (\texttt{pop)} and number of opportunities (\texttt{opp}), an
indicator for catchments or other eligibility constraints (\texttt{r}),
and a pre-calculated impedance function (\texttt{f}). For this example,
we assume that there are no catchment restrictions by setting \texttt{r}
to 1.

The value of the function (its output) is a vector with \(V_ij\) given
the inputs, that is, the opportunities available to \(i\) from \(j\):

Figure \ref{fig:toy-example-availability-jobs} shows the estimates of
spatial availability:

\begin{figure}
\includegraphics[width=1\linewidth]{Spatial-Availability_files/figure-latex/toy-example-availability-jobs-1} \caption{\label{fig:toy-example-availability-jobs}Spatial availability of jobs from population centers for the simple numerical example}\label{fig:toy-example-availability-jobs}
\end{figure}

We see that population center 5 has the highest level of spatial
availability, due to being a large population center that is moreover
relatively close to jobs. To improve the interpretability of this
measure, we first note that the regional measure of jobs per capita is
0.994. We then calculate the spatially available jobs per person by
dividing each spatial availability value by the population at each
population center (Figure
\ref{fig:toy-example-availability-jobs-per-capita}).

Some population centers have almost two jobs available per person
(compared to the overall regional value of approximately one job per
person), while others have less than one job available per person. This
does not mean that people are not taking some of the jobs. It means that
controlling for the cost of reaching jobs, they are worse off than those
with more jobs spatially available.

\begin{figure}
\includegraphics[width=1\linewidth]{Spatial-Availability_files/figure-latex/toy-example-availability-jobs-per-capita-1} \caption{\label{fig:toy-example-availability-jobs-per-capita}Spatial availability of jobs per capita from population centers for the simple numerical example}\label{fig:toy-example-availability-jobs-per-capita}
\end{figure}

\hypertarget{alternative-use-case-2-available-jobs-for-specialized-working-populations}{%
\subsubsection{Alternative Use Case 2: Available Jobs for Specialized
Working
Populations}\label{alternative-use-case-2-available-jobs-for-specialized-working-populations}}

In this sub-section we introduce catchment/eligibility constraints. Due
to differences in educational achievement among the population, the jobs
in Employment Center 1 can only be taken by individuals in population
centers 1 and 2. Jobs in Employment Center 2 can be taken by individuals
in population centers 3, 4, 5, 7, and 8. Lastly, jobs in Employment
Center 3 require qualifications available only among individuals in
population centers 5, 6, 8, and 9.

Calculate the spatial availability by proportionally allocating
\emph{specialized} workers to jobs (we refer to spatial availability in
this case as \(V_ij_r\)):

Plot the availability estimates:

\begin{figure}
\includegraphics[width=1\linewidth]{Spatial-Availability_files/figure-latex/toy-example-availability-with-catchments-1} \caption{\label{fig:toy-example-availability-with-catchments}Spatial availability of jobs from population centers assuming catchment restrictions for the simple numerical example}\label{fig:toy-example-availability-with-catchments}
\end{figure}

Available jobs per person with catchment/eligibility conditions:

The plot in Figure
\ref{fig:toy-example-availability-with-catchments-per-capita} shows the
availability per person without and with catchment restrictions.

\begin{figure}
\includegraphics[width=1\linewidth]{Spatial-Availability_files/figure-latex/toy-example-availability-with-catchments-per-capita-1} \caption{\label{fig:toy-example-availability-with-catchments-per-capita}Spatial availability of jobs per capita of jobs from population centers with and without catchment restrictions for the simple numerical example}\label{fig:toy-example-availability-with-catchments-per-capita}
\end{figure}

We can see that when there are catchment restrictions population center
2, despite being relatively peripheral, has higher spatial availability
due to spatial specialization. With catchments, the spatial availability
of jobs declines from the perspective of population center 4: the
population here has skills required for jobs at a small employment
center, where they face substantial competition from other population
centers.

\hypertarget{alternative-use-case-3-available-workers-for-employment-centers}{%
\subsubsection{Alternative Use Case 3: Available Workers for Employment
Centers}\label{alternative-use-case-3-available-workers-for-employment-centers}}

We can also examine the pool of workers available to each employment
center by considering the workers as the opportunities and the jobs as
the population.

Calculate the spatial availability by proportionally allocating jobs to
workers (we refer to spatial availability in this case as \(W_ji\)) as
follows:

Plot the availability estimates:

\begin{figure}
\includegraphics[width=1\linewidth]{Spatial-Availability_files/figure-latex/toy-example-availability-workers-1} \caption{\label{fig:toy-example-availability-workers}Spatial availability of workers}\label{fig:toy-example-availability-workers}
\end{figure}

Plot the spatial availability of workers per job:

\begin{figure}
\includegraphics[width=1\linewidth]{Spatial-Availability_files/figure-latex/toy-example-availability-workers-per-job-1} \caption{\label{fig:toy-example-availability-workers-per-job}Spatial availability of workers per job}\label{fig:toy-example-availability-workers-per-job}
\end{figure}

\hypertarget{limitations}{%
\subsection{Limitations}\label{limitations}}

still does not tell us how many accessible opportunities will lead to
participation/positive outcomes; it does come closer\ldots{} this is an
important question for equity analysis.

\hypertarget{conclusion}{%
\section{Conclusion}\label{conclusion}}

Words go here.

\hypertarget{references}{%
\section*{References}\label{references}}
\addcontentsline{toc}{section}{References}

\hypertarget{refs}{}
\begin{CSLReferences}{1}{0}
\leavevmode\vadjust pre{\hypertarget{ref-allen2019}{}}%
Allen, J., Farber, S., 2019. A Measure of Competitive Access to
Destinations for Comparing Across Multiple Study Regions. Geographical
Analysis 52, 69--86.
doi:\href{https://doi.org/10.1111/gean.12188}{10.1111/gean.12188}

\leavevmode\vadjust pre{\hypertarget{ref-deboosere2018}{}}%
Deboosere, R., El-Geneidy, A.M., Levinson, D., 2018.
Accessibility-oriented development. Journal of Transport Geography 70,
11--20.
doi:\href{https://doi.org/10.1016/j.jtrangeo.2018.05.015}{10.1016/j.jtrangeo.2018.05.015}

\leavevmode\vadjust pre{\hypertarget{ref-delamater2013spatial}{}}%
Delamater, P.L., 2013. Spatial accessibility in suboptimally configured
health care systems: A modified two-step floating catchment area
(M2SFCA) metric. Health \& Place 24, 30--43.
doi:\href{https://doi.org/10.1016/j.healthplace.2013.07.012}{10.1016/j.healthplace.2013.07.012}

\leavevmode\vadjust pre{\hypertarget{ref-fitdistrplus_2015}{}}%
Delignette-Muller, M.L., Dutang, C., 2015. {fitdistrplus}: An {R}
package for fitting distributions. Journal of Statistical Software 64,
1--34.

\leavevmode\vadjust pre{\hypertarget{ref-geurs2004}{}}%
Geurs, K.T., van Wee, B., 2004. Accessibility evaluation of land-use and
transport strategies: review and research directions. Journal of
Transport Geography 12, 127--140.
doi:\href{https://doi.org/10.1016/j.jtrangeo.2003.10.005}{10.1016/j.jtrangeo.2003.10.005}

\leavevmode\vadjust pre{\hypertarget{ref-handy2020}{}}%
Handy, S., 2020. Is accessibility an idea whose time has finally come?
Transportation Research Part D: Transport and Environment 83, 102319.
doi:\href{https://doi.org/10.1016/j.trd.2020.102319}{10.1016/j.trd.2020.102319}

\leavevmode\vadjust pre{\hypertarget{ref-hansen1959}{}}%
Hansen, W.G., 1959. How Accessibility Shapes Land Use. Journal of the
American Institute of Planners 25, 73--76.
doi:\href{https://doi.org/10.1080/01944365908978307}{10.1080/01944365908978307}

\leavevmode\vadjust pre{\hypertarget{ref-joseph1984}{}}%
Joseph, A.E., Bantock, P.R., 1984. Rural Accessibility of General
Practitioners: the Case of Bruce and Grey Counties, ONTARIO,
1901{\textendash}1981. The Canadian Geographer/Le GÃ©ographe canadien 28,
226--239.
doi:\href{https://doi.org/10.1111/j.1541-0064.1984.tb00788.x}{10.1111/j.1541-0064.1984.tb00788.x}

\leavevmode\vadjust pre{\hypertarget{ref-luo2003}{}}%
Luo, W., Wang, F., 2003. Measures of Spatial Accessibility to Health
Care in a GIS Environment: Synthesis and a Case Study in the Chicago
Region. Environment and Planning B: Planning and Design 30, 865--884.
doi:\href{https://doi.org/10.1068/b29120}{10.1068/b29120}

\leavevmode\vadjust pre{\hypertarget{ref-miller2018}{}}%
Miller, E.J., 2018. Accessibility: measurement and application in
transportation planning. Transport Reviews 38, 551--555.
doi:\href{https://doi.org/10.1080/01441647.2018.1492778}{10.1080/01441647.2018.1492778}

\leavevmode\vadjust pre{\hypertarget{ref-paez2019}{}}%
Paez, A., Higgins, C.D., Vivona, S.F., 2019. Demand and level of service
inflation in Floating Catchment Area (FCA) methods. PLOS ONE 14,
e0218773.
doi:\href{https://doi.org/10.1371/journal.pone.0218773}{10.1371/journal.pone.0218773}

\leavevmode\vadjust pre{\hypertarget{ref-proffitt2017}{}}%
Proffitt, D.G., Bartholomew, K., Ewing, R., Miller, H.J., 2017.
Accessibility planning in American metropolitan areas: Are we there yet?
Urban Studies 56, 167--192.
doi:\href{https://doi.org/10.1177/0042098017710122}{10.1177/0042098017710122}

\leavevmode\vadjust pre{\hypertarget{ref-R_2021}{}}%
R Core Team, 2021. R: A language and environment for statistical
computing. R Foundation for Statistical Computing, Vienna, Austria.

\leavevmode\vadjust pre{\hypertarget{ref-shen1998}{}}%
Shen, Q., 1998. Location characteristics of inner-city neighborhoods and
employment accessibility of low-wage workers. Environment and Planning
B: Planning and Design 25, 345--365.
doi:\href{https://doi.org/10.1068/b250345}{10.1068/b250345}

\leavevmode\vadjust pre{\hypertarget{ref-wan2012three}{}}%
Wan, N., Zou, B., Sternberg, T., 2012. A three-step floating catchment
area method for analyzing spatial access to health services.
International Journal of Geographical Information Science 26,
1073--1089.
doi:\href{https://doi.org/10.1080/13658816.2011.624987}{10.1080/13658816.2011.624987}

\leavevmode\vadjust pre{\hypertarget{ref-wilson1971}{}}%
Wilson, A.G., 1971. A Family of Spatial Interaction Models, and
Associated Developments. Environment and Planning A: Economy and Space
3, 1--32. doi:\href{https://doi.org/10.1068/a030001}{10.1068/a030001}

\leavevmode\vadjust pre{\hypertarget{ref-yan2021}{}}%
Yan, X., 2021. Toward Accessibility-Based Planning. Journal of the
American Planning Association 87, 409--423.
doi:\href{https://doi.org/10.1080/01944363.2020.1850321}{10.1080/01944363.2020.1850321}

\end{CSLReferences}


\end{document}
