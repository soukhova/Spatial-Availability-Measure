geom_sf(data = indexed_measures_pos, fill = "#999999") +
geom_sf(data = toronto_muni_bound, # border for Toronto
colour=alpha("dimgrey",1),
size = 0.5, fill=NA,
show.legend = "polygon") +
annotation_north_arrow(location = "tl", # north arrow for both the main plot and inset
height = unit(0.8, "cm"),
width = unit(0.8, "cm"),
style = north_arrow_orienteering(line_width = 0.25,
line_col = "dimgrey",
fill = c("white","dimgrey"))) +
annotation_scale(bar_cols = c("dimgrey", "white"), # scale bar for both the main plot and inset
height = unit(0.15, "cm")) +
guides(fill = guide_legend(reverse = FALSE)) +
theme_void() +
theme(legend.position = "right")
indexed_change
t <- indexed_measures_neg %>% st_drop_geometry()
cor(t[, c('workers', 'jobs', "TO_A_i", "TO_V_i", "trips_i", "A_indexed", "V_indexed", "A_V_indexed_change", "TO_avgtt_i")])
plot_workers<- ggplot() +
geom_sf(data = indexed_measures_neg,
aes(fill= workers), color = NA) +
scale_fill_distiller(palette = "Spectral", name = "# of Workers",
limits = c(0, max(indexed_measures_neg$workers)))+
geom_sf(data = toronto_muni_bound, colour="black", fill=NA) +
guides(size = "none") +
theme(legend.position = "right",
panel.grid = element_blank(),
panel.background = element_rect(size = 1,
color = "black",
fill = NA))
plot_imp<- ggplot() +
geom_sf(data = indexed_measures_neg,
aes(fill= TO_avg_f_i), color = NA) +
scale_fill_distiller(palette = "Spectral", name = "Travel Cost Value",
limits = c(0, max(indexed_measures_neg$TO_avg_f_i)))+
geom_sf(data = toronto_muni_bound, colour="black", fill=NA) +
guides(size = "none") +
theme(legend.position = "right",
panel.grid = element_blank(),
panel.background = element_rect(size = 1,
color = "black",
fill = NA))
plot_workers / plot_imp
plot_workers<- ggplot() +
geom_sf(data = indexed_measures_neg,
aes(fill= workers), color = NA) +
scale_fill_distiller(palette = "Spectral", name = "# of Workers",
limits = c(0, max(indexed_measures_neg$workers)))+
geom_sf(data = toronto_muni_bound, colour="black", fill=NA) +
guides(size = "none") +
theme_void() +
theme(legend.position = "right")
plot_imp<- ggplot() +
geom_sf(data = indexed_measures_neg,
aes(fill= TO_avg_f_i), color = NA) +
scale_fill_distiller(palette = "Spectral", name = "Travel Cost Value",
limits = c(0, max(indexed_measures_neg$TO_avg_f_i)))+
geom_sf(data = toronto_muni_bound, colour="black", fill=NA) +
guides(size = "none") +
tbeme_void() +
theme(legend.position = "right")
plot_imp<- ggplot() +
geom_sf(data = indexed_measures_neg,
aes(fill= TO_avg_f_i), color = NA) +
scale_fill_distiller(palette = "Spectral", name = "Travel Cost Value",
limits = c(0, max(indexed_measures_neg$TO_avg_f_i)))+
geom_sf(data = toronto_muni_bound, colour="black", fill=NA) +
guides(size = "none") +
theme_void() +
theme(legend.position = "right")
plot_workers / plot_imp
plot_workers <- ggplot() +
geom_sf(data = indexed_measures_neg, aes(fill= workers), color = NA) + #data
scale_fill_distiller(palette = "Spectral", #legend scale bar
name = "# of Workers",
limits = c(0, max(indexed_measures_neg$workers)),
na.value = "grey80") +
geom_sf(data = toronto_muni_bound, # border for Toronto
colour=alpha("dimgrey",1),
size = 0.5, fill=NA,
show.legend = "polygon") +
annotation_north_arrow(location = "tl", # north arrow for both the main plot and inset
height = unit(0.8, "cm"),
width = unit(0.8, "cm"),
style = north_arrow_orienteering(line_width = 0.25,
line_col = "dimgrey",
fill = c("white","dimgrey"))) +
annotation_scale(bar_cols = c("dimgrey", "white"), # scale bar for both the main plot and inset
height = unit(0.15, "cm")) +
geom_rect(data = data.frame(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin, # rectangle on main plot marking inset location
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
aes(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin,
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
fill = NA, colour = "dimgrey", size = 1) +
theme_void() +
theme(legend.position = c(1.15, 0.75),
plot.margin = margin(t = 0, r = 0, b = 0, l = -80)) # positing legend and clipping out white space
#main plot + adding the inset map.
plot_workers <- ggdraw( plot_workers) +
draw_plot({ plot_workers + coord_sf(xlim = st_coordinates(bbox_new)[c(1,2),1],
ylim = st_coordinates(bbox_new)[c(2,3),2],
expand = FALSE) +
theme(legend.position = "none")},
x = 0.57, y = 0.01,  # The distance along a (0,1) x-axis (and y axis) to draw the left edge (the bottom edge) of the plot
width = 0.46, height = 0.46) # The width and height of the plot expressed as proportion of the entire ggdraw object
plot_imp <- ggplot() +
geom_sf(data = indexed_measures_neg, aes(fill= TO_avg_f_i), color = NA) + #data
scale_fill_distiller(palette = "Spectral", #legend scale bar
name = "# of Workers",
limits = c(0, max(indexed_measures_neg$TO_avg_f_i)),
na.value = "grey80") +
geom_sf(data = toronto_muni_bound, # border for Toronto
colour=alpha("dimgrey",1),
size = 0.5, fill=NA,
show.legend = "polygon") +
annotation_north_arrow(location = "tl", # north arrow for both the main plot and inset
height = unit(0.8, "cm"),
width = unit(0.8, "cm"),
style = north_arrow_orienteering(line_width = 0.25,
line_col = "dimgrey",
fill = c("white","dimgrey"))) +
annotation_scale(bar_cols = c("dimgrey", "white"), # scale bar for both the main plot and inset
height = unit(0.15, "cm")) +
geom_rect(data = data.frame(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin, # rectangle on main plot marking inset location
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
aes(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin,
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
fill = NA, colour = "dimgrey", size = 1) +
theme_void() +
theme(legend.position = c(1.15, 0.75),
plot.margin = margin(t = 0, r = 0, b = 0, l = -80)) # positing legend and clipping out white space
#main plot + adding the inset map.
plot_imp <- ggdraw( plot_imp) +
draw_plot({ plot_imp + coord_sf(xlim = st_coordinates(bbox_new)[c(1,2),1],
ylim = st_coordinates(bbox_new)[c(2,3),2],
expand = FALSE) +
theme(legend.position = "none")},
x = 0.57, y = 0.01,  # The distance along a (0,1) x-axis (and y axis) to draw the left edge (the bottom edge) of the plot
width = 0.46, height = 0.46) # The width and height of the plot expressed as proportion of the entire ggdraw object
plot_workers / plot_imp
plot_workers <- ggplot() +
geom_sf(data = indexed_measures_neg, aes(fill= workers), color = NA) + #data
scale_fill_distiller(palette = "Spectral", #legend scale bar
name = "# of Workers",
limits = c(0, max(indexed_measures_neg$workers)),
na.value = "grey80") +
geom_sf(data = toronto_muni_bound, # border for Toronto
colour=alpha("#5E4FA2",1),
size = 0.5, fill=NA,
show.legend = "polygon") +
annotation_north_arrow(location = "tl", # north arrow for both the main plot and inset
height = unit(0.8, "cm"),
width = unit(0.8, "cm"),
style = north_arrow_orienteering(line_width = 0.25,
line_col = "dimgrey",
fill = c("white","dimgrey"))) +
annotation_scale(bar_cols = c("dimgrey", "white"), # scale bar for both the main plot and inset
height = unit(0.15, "cm")) +
geom_rect(data = data.frame(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin, # rectangle on main plot marking inset location
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
aes(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin,
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
fill = NA, colour = "dimgrey", size = 1) +
theme_void() +
theme(legend.position = c(1.15, 0.75),
plot.margin = margin(t = 0, r = 0, b = 0, l = -80)) # positing legend and clipping out white space
#main plot + adding the inset map.
plot_workers <- ggdraw( plot_workers) +
draw_plot({ plot_workers + coord_sf(xlim = st_coordinates(bbox_new)[c(1,2),1],
ylim = st_coordinates(bbox_new)[c(2,3),2],
expand = FALSE) +
theme(legend.position = "none")},
x = 0.57, y = 0.01,  # The distance along a (0,1) x-axis (and y axis) to draw the left edge (the bottom edge) of the plot
width = 0.46, height = 0.46) # The width and height of the plot expressed as proportion of the entire ggdraw object
plot_imp <- ggplot() +
geom_sf(data = indexed_measures_neg, aes(fill= TO_avg_f_i), color = NA) + #data
scale_fill_distiller(palette = "Spectral", #legend scale bar
name = "# of Workers",
limits = c(0, max(indexed_measures_neg$TO_avg_f_i)),
na.value = "grey80") +
geom_sf(data = toronto_muni_bound, # border for Toronto
colour=alpha("dimgrey",1),
size = 0.5, fill=NA,
show.legend = "polygon") +
annotation_north_arrow(location = "tl", # north arrow for both the main plot and inset
height = unit(0.8, "cm"),
width = unit(0.8, "cm"),
style = north_arrow_orienteering(line_width = 0.25,
line_col = "dimgrey",
fill = c("white","dimgrey"))) +
annotation_scale(bar_cols = c("dimgrey", "white"), # scale bar for both the main plot and inset
height = unit(0.15, "cm")) +
geom_rect(data = data.frame(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin, # rectangle on main plot marking inset location
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
aes(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin,
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
fill = NA, colour = "dimgrey", size = 1) +
theme_void() +
theme(legend.position = c(1.15, 0.75),
plot.margin = margin(t = 0, r = 0, b = 0, l = -80)) # positing legend and clipping out white space
#main plot + adding the inset map.
plot_imp <- ggdraw( plot_imp) +
draw_plot({ plot_imp + coord_sf(xlim = st_coordinates(bbox_new)[c(1,2),1],
ylim = st_coordinates(bbox_new)[c(2,3),2],
expand = FALSE) +
theme(legend.position = "none")},
x = 0.57, y = 0.01,  # The distance along a (0,1) x-axis (and y axis) to draw the left edge (the bottom edge) of the plot
width = 0.46, height = 0.46) # The width and height of the plot expressed as proportion of the entire ggdraw object
plot_workers / plot_imp
plot_workers <- ggplot() +
geom_sf(data = indexed_measures_neg, aes(fill= workers), color = NA) + #data
scale_fill_distiller(palette = "Spectral", #legend scale bar
name = "# of Workers",
limits = c(0, max(indexed_measures_neg$workers)),
na.value = "grey80") +
geom_sf(data = toronto_muni_bound, # border for Toronto
colour=alpha("#3288BD",1),
size = 0.5, fill=NA,
show.legend = "polygon") +
annotation_north_arrow(location = "tl", # north arrow for both the main plot and inset
height = unit(0.8, "cm"),
width = unit(0.8, "cm"),
style = north_arrow_orienteering(line_width = 0.25,
line_col = "dimgrey",
fill = c("white","dimgrey"))) +
annotation_scale(bar_cols = c("dimgrey", "white"), # scale bar for both the main plot and inset
height = unit(0.15, "cm")) +
geom_rect(data = data.frame(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin, # rectangle on main plot marking inset location
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
aes(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin,
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
fill = NA, colour = "dimgrey", size = 1) +
theme_void() +
theme(legend.position = c(1.15, 0.75),
plot.margin = margin(t = 0, r = 0, b = 0, l = -80)) # positing legend and clipping out white space
#main plot + adding the inset map.
plot_workers <- ggdraw( plot_workers) +
draw_plot({ plot_workers + coord_sf(xlim = st_coordinates(bbox_new)[c(1,2),1],
ylim = st_coordinates(bbox_new)[c(2,3),2],
expand = FALSE) +
theme(legend.position = "none")},
x = 0.57, y = 0.01,  # The distance along a (0,1) x-axis (and y axis) to draw the left edge (the bottom edge) of the plot
width = 0.46, height = 0.46) # The width and height of the plot expressed as proportion of the entire ggdraw object
plot_imp <- ggplot() +
geom_sf(data = indexed_measures_neg, aes(fill= TO_avg_f_i), color = NA) + #data
scale_fill_distiller(palette = "Spectral", #legend scale bar
name = "# of Workers",
limits = c(0, max(indexed_measures_neg$TO_avg_f_i)),
na.value = "grey80") +
geom_sf(data = toronto_muni_bound, # border for Toronto
colour=alpha("#3288BD",1),
size = 0.5, fill=NA,
show.legend = "polygon") +
annotation_north_arrow(location = "tl", # north arrow for both the main plot and inset
height = unit(0.8, "cm"),
width = unit(0.8, "cm"),
style = north_arrow_orienteering(line_width = 0.25,
line_col = "dimgrey",
fill = c("white","dimgrey"))) +
annotation_scale(bar_cols = c("dimgrey", "white"), # scale bar for both the main plot and inset
height = unit(0.15, "cm")) +
geom_rect(data = data.frame(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin, # rectangle on main plot marking inset location
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
aes(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin,
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
fill = NA, colour = "dimgrey", size = 1) +
theme_void() +
theme(legend.position = c(1.15, 0.75),
plot.margin = margin(t = 0, r = 0, b = 0, l = -80)) # positing legend and clipping out white space
#main plot + adding the inset map.
plot_imp <- ggdraw( plot_imp) +
draw_plot({ plot_imp + coord_sf(xlim = st_coordinates(bbox_new)[c(1,2),1],
ylim = st_coordinates(bbox_new)[c(2,3),2],
expand = FALSE) +
theme(legend.position = "none")},
x = 0.57, y = 0.01,  # The distance along a (0,1) x-axis (and y axis) to draw the left edge (the bottom edge) of the plot
width = 0.46, height = 0.46) # The width and height of the plot expressed as proportion of the entire ggdraw object
plot_workers / plot_imp
mplot_SApW_TTS <- ggplot() +
geom_sf(data = TO_taz_acc, aes(fill= TO_V_i/workers), color = NA) + #data
scale_fill_distiller(palette = "Spectral", #legend scale bar
name = "Spatially Availability \n per Worker (v_i)",
limits = c(0, max(TO_taz_acc$TO_V_i / TO_taz_acc$workers)),
na.value = "grey80") +
geom_sf(data = toronto_muni_bound, # border for Toronto
colour=alpha("#3288BD",1),
size = 0.5, fill=NA,
show.legend = "polygon") +
annotation_north_arrow(location = "tl", # north arrow for both the main plot and inset
height = unit(0.8, "cm"),
width = unit(0.8, "cm"),
style = north_arrow_orienteering(line_width = 0.25,
line_col = "dimgrey",
fill = c("white","dimgrey"))) +
annotation_scale(bar_cols = c("dimgrey", "white"), # scale bar for both the main plot and inset
height = unit(0.15, "cm")) +
geom_rect(data = data.frame(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin, # rectangle on main plot marking inset location
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
aes(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin,
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
fill = NA, colour = "dimgrey", size = 1) +
theme_void() +
theme(legend.position = c(1.15, 0.75),
plot.margin = margin(t = 0, r = 0, b = 0, l = -80)) # positing legend and clipping out white space
#main plot + adding the inset map.
mplot_SApW_TTS <- ggdraw(mplot_SApW_TTS) +
draw_plot({mplot_SApW_TTS + coord_sf(xlim = st_coordinates(bbox_new)[c(1,2),1],
ylim = st_coordinates(bbox_new)[c(2,3),2],
expand = FALSE) +
theme(legend.position = "none")},
x = 0.57, y = 0.01,  # The distance along a (0,1) x-axis (and y axis) to draw the left edge (the bottom edge) of the plot
width = 0.46, height = 0.46) # The width and height of the plot expressed as proportion of the entire ggdraw object
mplot_SApW_TTS
mplot_SApW_TTS <- ggplot() +
geom_sf(data = TO_taz_acc, aes(fill= TO_V_i/workers), color = NA) + #data
scale_fill_distiller(palette = "Spectral", #legend scale bar
name = "Spatially Availability \n per Worker (v_i)",
limits = c(0, max(TO_taz_acc$TO_V_i / TO_taz_acc$workers)),
na.value = "grey80") +
geom_sf(data = toronto_muni_bound, # border for Toronto
colour=alpha("dimgrey",1),
size = 0.5, fill=NA,
show.legend = "polygon") +
annotation_north_arrow(location = "tl", # north arrow for both the main plot and inset
height = unit(0.8, "cm"),
width = unit(0.8, "cm"),
style = north_arrow_orienteering(line_width = 0.25,
line_col = "dimgrey",
fill = c("white","dimgrey"))) +
annotation_scale(bar_cols = c("dimgrey", "white"), # scale bar for both the main plot and inset
height = unit(0.15, "cm")) +
geom_rect(data = data.frame(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin, # rectangle on main plot marking inset location
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
aes(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin,
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
fill = NA, colour = "dimgrey", size = 1) +
theme_void() +
theme(legend.position = c(1.15, 0.75),
plot.margin = margin(t = 0, r = 0, b = 0, l = -80)) # positing legend and clipping out white space
#main plot + adding the inset map.
mplot_SApW_TTS <- ggdraw(mplot_SApW_TTS) +
draw_plot({mplot_SApW_TTS + coord_sf(xlim = st_coordinates(bbox_new)[c(1,2),1],
ylim = st_coordinates(bbox_new)[c(2,3),2],
expand = FALSE) +
theme(legend.position = "none")},
x = 0.57, y = 0.01,  # The distance along a (0,1) x-axis (and y axis) to draw the left edge (the bottom edge) of the plot
width = 0.46, height = 0.46) # The width and height of the plot expressed as proportion of the entire ggdraw object
mplot_SApW_TTS
plot_workers <- ggplot() +
geom_sf(data = indexed_measures_neg, aes(fill= workers), color = NA) + #data
scale_fill_distiller(palette = "Spectral", #legend scale bar
name = "# of Workers",
limits = c(0, max(indexed_measures_neg$workers)),
na.value = "grey80") +
geom_sf(data = toronto_muni_bound, # border for Toronto
colour=alpha("dimgrey",1),
size = 0.5, fill=NA,
show.legend = "polygon") +
annotation_north_arrow(location = "tl", # north arrow for both the main plot and inset
height = unit(0.8, "cm"),
width = unit(0.8, "cm"),
style = north_arrow_orienteering(line_width = 0.25,
line_col = "dimgrey",
fill = c("white","dimgrey"))) +
annotation_scale(bar_cols = c("dimgrey", "white"), # scale bar for both the main plot and inset
height = unit(0.15, "cm")) +
geom_rect(data = data.frame(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin, # rectangle on main plot marking inset location
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
aes(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin,
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
fill = NA, colour = "dimgrey", size = 1) +
theme_void() +
theme(legend.position = c(1.15, 0.75),
plot.margin = margin(t = 0, r = 0, b = 0, l = -80)) # positing legend and clipping out white space
#main plot + adding the inset map.
plot_workers <- ggdraw( plot_workers) +
draw_plot({ plot_workers + coord_sf(xlim = st_coordinates(bbox_new)[c(1,2),1],
ylim = st_coordinates(bbox_new)[c(2,3),2],
expand = FALSE) +
theme(legend.position = "none")},
x = 0.57, y = 0.01,  # The distance along a (0,1) x-axis (and y axis) to draw the left edge (the bottom edge) of the plot
width = 0.46, height = 0.46) # The width and height of the plot expressed as proportion of the entire ggdraw object
plot_imp <- ggplot() +
geom_sf(data = indexed_measures_neg, aes(fill= TO_avg_f_i), color = NA) + #data
scale_fill_distiller(palette = "Spectral", #legend scale bar
name = "# of Workers",
limits = c(0, max(indexed_measures_neg$TO_avg_f_i)),
na.value = "grey80") +
geom_sf(data = toronto_muni_bound, # border for Toronto
colour=alpha("dimgrey",1),
size = 0.5, fill=NA,
show.legend = "polygon") +
annotation_north_arrow(location = "tl", # north arrow for both the main plot and inset
height = unit(0.8, "cm"),
width = unit(0.8, "cm"),
style = north_arrow_orienteering(line_width = 0.25,
line_col = "dimgrey",
fill = c("white","dimgrey"))) +
annotation_scale(bar_cols = c("dimgrey", "white"), # scale bar for both the main plot and inset
height = unit(0.15, "cm")) +
geom_rect(data = data.frame(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin, # rectangle on main plot marking inset location
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
aes(xmin = bbox_new1$xmin, ymin = bbox_new1$ymin,
xmax = bbox_new1$xmax, ymax = bbox_new1$ymax),
fill = NA, colour = "dimgrey", size = 1) +
theme_void() +
theme(legend.position = c(1.15, 0.75),
plot.margin = margin(t = 0, r = 0, b = 0, l = -80)) # positing legend and clipping out white space
#main plot + adding the inset map.
plot_imp <- ggdraw( plot_imp) +
draw_plot({ plot_imp + coord_sf(xlim = st_coordinates(bbox_new)[c(1,2),1],
ylim = st_coordinates(bbox_new)[c(2,3),2],
expand = FALSE) +
theme(legend.position = "none")},
x = 0.57, y = 0.01,  # The distance along a (0,1) x-axis (and y axis) to draw the left edge (the bottom edge) of the plot
width = 0.46, height = 0.46) # The width and height of the plot expressed as proportion of the entire ggdraw object
plot_workers / plot_imp
#dgamma is the density plot for gamma function
ggplot(data = plot_data3, aes(x = travel_time, y = prop_trips, colour=estimate,linetype=estimate,shape=estimate)) +
geom_point(size = 2) +
geom_line(size=1) +
labs(title = "Trip length distribution",
x = "Home-based car travel time to work (min)",
y = "Proportion of trips") +
scale_color_manual("Distribution",
values = c("Empirical" = "Black",
"Calibrated" = "Red"))    +
scale_linetype_manual("Distribution",values=c(0,1)) +
scale_shape_manual("Distribution",values=c(16,NA))+
theme_light() +
theme(plot.title = element_text(hjust=0.5),
legend.position = c(0.85,0.80),
panel.border = element_major())
#dgamma is the density plot for gamma function
ggplot(data = plot_data3, aes(x = travel_time, y = prop_trips, colour=estimate,linetype=estimate,shape=estimate)) +
geom_point(size = 2) +
geom_line(size=1) +
labs(title = "Trip length distribution",
x = "Home-based car travel time to work (min)",
y = "Proportion of trips") +
scale_color_manual("Distribution",
values = c("Empirical" = "Black",
"Calibrated" = "Red"))    +
scale_linetype_manual("Distribution",values=c(0,1)) +
scale_shape_manual("Distribution",values=c(16,NA))+
theme_light() +
theme(plot.title = element_text(hjust=0.5),
legend.position = c(0.85,0.80),
panel.border = element_blank())
#dgamma is the density plot for gamma function
ggplot(data = plot_data3, aes(x = travel_time, y = prop_trips, colour=estimate,linetype=estimate,shape=estimate)) +
geom_point(size = 2) +
geom_line(size=1) +
labs(title = "Trip length distribution",
x = "Home-based car travel time to work (min)",
y = "Proportion of trips") +
scale_color_manual("Distribution",
values = c("Empirical" = "Black",
"Calibrated" = "Red"))    +
scale_linetype_manual("Distribution",values=c(0,1)) +
scale_shape_manual("Distribution",values=c(16,NA))+
theme_light() +
theme(plot.title = element_text(hjust=0.5),
legend.position = c(0.85,0.80),
axis.line = element_line(colour = "black"),
panel.border = element_blank())
```{r TTS-16-survey-area, echo=FALSE, fig.cap="\\label{fig:TTS-16-survey-area}The TTS 2016 study area within the Greater Golden Horseshoe in Ontario, Canada.", fig.height=5}
knitr::include_graphics("images/Greater-Golden-Horseshoe-Map.png")
knitr::include_graphics("images/Greater-Golden-Horseshoe-Map.png")
ggplot() +
geom_sf(data = toy_sim_zones_access %>%
filter(type == "jobs"),
aes(fill = W_j, size = W_j, shape = type)) +
geom_sf(data = toy_sim_zones_access %>%
filter(type == "population"),
aes(shape = type),
size = 6, fill = "black") +
geom_sf_text(data = toy_sim_zones_access , aes(label = id_short),
size = 3, nudge_y = -400) +
scale_shape_manual(values = c('population' = 24, 'jobs' = 21), name = "Location Type", labels=c("Population", "Jobs"),
guide = guide_legend(order = 2)) +
scale_size_continuous(range = c(5,10), name = "Spatial Availability \n(W_j)", guide = "none") +
scale_fill_distiller(palette = "Greens", direction = 1, name = "Spatial Availability \n(W_j)",
limits = c(0, max(toy_sim_zones_access$W_j)),
guide = guide_colourbar(order = 1)) +
theme(legend.position = "right", axis.text = element_blank(), axis.title = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(size = 1.5,
color = "grey",
fill = "gray95"))
ggplot() +
geom_sf(data = toy_sim_zones_access %>%
filter(type == "jobs"),
aes(fill = W_j, size = W_j, shape = type)) +
geom_sf(data = toy_sim_zones_access %>%
filter(type == "population"),
aes(shape = type),
size = 6, fill = "black") +
geom_sf_text(data = toy_sim_zones_access , aes(label = id_short),
size = 3, nudge_y = -400) +
scale_shape_manual(values = c('population' = 24, 'jobs' = 21), name = "Location Type", labels=c("Population", "Jobs"),
guide = guide_legend(order = 2)) +
scale_size_continuous(range = c(1,11), name = "Spatial Availability \n(W_j)", guide = "none") +
scale_fill_distiller(palette = "Greens", direction = 1, name = "Spatial Availability \n(W_j)",
limits = c(0, max(toy_sim_zones_access$W_j)),
guide = guide_colourbar(order = 1)) +
theme(legend.position = "right", axis.text = element_blank(), axis.title = element_blank(),
panel.grid = element_blank(),
panel.background = element_rect(size = 1.5,
color = "grey",
fill = "gray95"))
